{% extends "index.html" %}
{% load custom_filter %}
{% load static %}
{% block content %}

<div class="menu-layer">
	<!-- <section class="hero-section about gap" style="background-image: url(https://bslthemes.com/html/quickeat/assets/img/background-1.png);">
		<div class="container mt-5">
			<div class="row align-items-center mx-0">
				<div class="col-lg-6" data-aos="fade-up"  data-aos-delay="300" data-aos-duration="400">
					<div class="about-text">
						<ul class="crumbs d-flex">
							<li><a href="{ % url 'home:home-page'  %}">Home</a></li>
							<li><a href="{%  url  'restaurant:restaurant'  %}"><i class="fa-solid fa-right-long"></i>Restaurants</a></li>
							<li class="two"><a href="{% url 'home:home-page' %}"><i class="fa-solid fa-right-long"></i>{{ restaurant.title }}</a></li>
						</ul>
						<div class="logo-detail">
							<img alt="{{restaurant.title}}" src="{{ restaurant.logo.url }}">
							<h2>{{restaurant.title}}</h2>
						</div>
						<div class="rate">
							<span>Rate:</span>
							<div class="star">
								{% for i in restaurant.rating|range_custom %}
									<i class="fa-solid fa-star"></i>
								{% endfor %}
								{% for i in restaurant.rating|range_diff:5 %}
									<i class="fa-regular fa-star"></i>
								{% endfor %}
							</div>
							<span>CUISINES:</span>
							<div class="cafa-button">
								{% for categorys in cat %}
								<a class="end" href="">{{categorys.title}}</a>
								{% endfor %}
							</div>
							<span>FEATURES:</span>
							<p>{{ restaurant.content }}</p>
							<div class="restaurant-card" data-latitude="{{ restaurant.latitude }}" data-longitude="{{ restaurant.longitude }}">
								{% if restaurant.start and restaurant.end %}
								<p><b>{{ restaurant.start }}</b> To <b>{{ restaurant.end }}</b></p>
								{% endif %}								
								<span>
									{% if restaurant.start|is_restaurant_open:restaurant.end %}
										<span class="text-success">Open</span>
									{% else %}
										<span class="text-danger">Closed</span>
									{% endif %}
								</span>
								{% if restaurant.lowest_price %}
								<p><strong>Delivery starts from:</strong> ${{ restaurant.lowest_price }}</p>
								{% else %}
								<p><strong>Delivery starts from:</strong>0$</p>
								{% endif %}
								<p class="distance">Distance: Calculating...</p>
							</div>							
						</div>
					</div>
				</div>
				<div class="col-lg-6" data-aos="fade-up"  data-aos-delay="400" data-aos-duration="500">
					<div class="about-img">
						<img alt="man" src="{% static 'images/restaurant-1.jpg' %}">
						<div class="hours">
							<i class="fa-regular fa-clock"></i>
							<h4>{% if restaurant.start and restaurant.end %}
								{{ restaurant.start }} To {{ restaurant.end }}
								{% endif %}	<br><span>Hours</span></h4>
						</div>
						<div class="hours two">
							<i class="fa-solid fa-utensils"></i>
							<h4>Breakfast, Lunch, Dinner<br><span>Meals</span></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section> -->
	<!-- new design -->
	<section class="hero-section about gap" style="background-image: url('https://bslthemes.com/html/quickeat/assets/img/background-1.png');">
		<img src="{{ restaurant.image.url }}" alt="{{restaurant.title}}" class="img-fluid w-100 mt-4" style="height: 400px; object-fit: cover;">
		<div class="container-fluid mt-5 position-relative">
			<div class="position-relative">
				<div class="d-flex flex-column align-items-start justify-content-center" style="position: absolute; bottom: -45px; padding: 30px;">
					<ul class="breadcrumb p-0 mb-5 d-flex align-items-center" style="background: none;">
						<li class="breadcrumb-item"><a href="{% url 'home:home-page' %}" class="text-decoration-none" style="color: white !important;">Home</a></li>
						<li class="breadcrumb-item"><a href="{% url 'restaurant:restaurant' %}" class="text-decoration-none" style="color: white !important;"><i class="fa-solid fa-right-long mx-1"></i>Restaurants</a></li>
						<li class="two">
							<a href="{% url 'restaurant:restaurant-card' restaurant.slug %}" style="color: white !important;">
								<i class="fa-solid fa-right-long"></i> <b>{{ restaurant.title }}</b>
							</a>
						</li>					
					</ul>
					<div class="d-flex align-items-center container">
						<div class="d-flex align-items-center container">
							<div class="row">
								<div class="col-md-4">
									<img src="{{ restaurant.logo.url }}" alt="{{restaurant.title}}" class="rounded-circle me-3" style="width: 220px;">
								</div>
								<div class="col-md-8">
									<div>
										<h4 class="mb-0" style="font-size: 2rem; font-weight: bold; color: white;">{{restaurant.title}}</h4>
										<div class="d-flex align-items-center mb-3">
											<span class="me-2 text-light">Rate:</span>
											<div class="star d-flex">
												{% for i in restaurant.rating|range_custom %}
												<i class="fa-solid fa-star text-warning"></i>
												{% endfor %}
												{% for i in restaurant.rating|range_diff:5 %}
												<i class="fa-regular fa-star text-warning"></i>
												{% endfor %}
											</div>
										</div>
										<div class="d-flex">
											<button class="book-table-btn me-2" id="openModal" data-bs-toggle="modal" data-bs-target="#exampleModal2">More Info</button>
											<button type="button" id="bookTableButton" class="book-table-btn me-2" data-bs-toggle="modal" data-bs-target="#exampleModal">Book A Table</button>
											<button class="feedback-btn book-table-btn me-2" id="openFeedbackModal">Feedback</button>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div id="feedbackModal" class="modal-feedback">
							<div class="modal-content-feedback">
							  <span class="close-feedback-btn" id="closeFeedbackModal">&times;</span>
							  <h3 class="text-warning">Leave Your Feedback</h3>
							  <form id="feedbackForm" method="POST" action="{% url 'home:submit_feedback' slug=restaurant.slug %}">
								{% csrf_token %}
								<div class="form-group">
								  <label for="rating">Rating:</label>
								  <input type="number" name="rating" id="rating" class="form-control" min="0" max="5" step="0.1" required>
								</div>
								<div class="form-group">
								  <label for="review">Review:</label>
								  <textarea name="review" id="review" class="form-control" rows="4"></textarea>
								</div>
								<button type="submit" class="btn-submit-feedback">Submit Feedback</button>
							  </form>
							</div>
						</div>
						<!-- The Modal -->
						<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
							<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
								<h3 class="modal-title text-warning" id="exampleModalLabel">More Information</h3>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body ">
									<div class="modal-content p-3 ">
										<div class="restaurant-card" data-latitude="{{ restaurant.latitude }}" data-longitude="{{ restaurant.longitude }}">
											{% if restaurant.start and restaurant.end %}
											<p><b>{{ restaurant.start }}</b> To <b>{{ restaurant.end }}</b></p>
											{% endif %}								
											<span>
												{% if restaurant.start|is_restaurant_open:restaurant.end %}
													<b><span class="text-success">Open</span></b>
												{% else %}
													<b><span class="text-danger">Closed</span></b>
												{% endif %}
											</span>
											{% if restaurant.lowest_price %}
											<p><strong>Delivery starts from:</strong> ${{ restaurant.lowest_price }}</p>
											{% else %}
											<p><strong>Delivery starts from:</strong>0$</p>
											{% endif %}
											<p class="distance">Distance: Calculating...</p>
										</div>
										</div>
									</div>
								</div>
							</div>
							</div>
						</div>
					<!-- Modal -->
						<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
							<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
								<h2 class="modal-title text-warning" id="exampleModalLabel">Make a table reservation</h2>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<form method="post" class="booking-form select-date-time-form" id="reservationForm" novalidate>
										{% csrf_token %}
										<div class="form-group">
											<p>Please select the number of people and the required date and time</p>
										</div>
										<div class="form-group">
											<input type="text" name="name" id="name" placeholder="Your Name" class="form-control required" required>
										</div>
										<div class="form-group">
											<input type="email" name="email" id="email" placeholder="Your Email" class="form-control required" required>
										</div>
										<div class="form-group">
											<input type="number" name="phone" id="phone" placeholder="Your Phone" class="form-control required" required>
										</div>
										<div class="form-group">
											<input type="text" id="BookingDate" class="form-control input datepicker checkin required" name="date" placeholder="Choose date" required>
										</div>
										<div class="form-group">
											<select class="form-control required" id="BookingTime" name="time" required>
												<option value="">Select time</option>
												{% for slot in time_slots %}
													<option value="{{ slot }}">{{ slot }}</option>
												{% endfor %}
											</select>
										</div>
										<div class="form-group">
											<select name="member" id="Persons" class="form-control" required>
												<option value="">Select number of people</option>
												<option value="1">1 person</option>
												<option selected value="2">2 people</option>
												<option value="3">3 people</option>
											</select>
										</div>
										<div class="form-group">
											<button class="btn-submit" type="submit" disabled>Submit</button>
										</div>
									</form>									
								</div>
							</div>
							</div>
						</div>
						{% comment %} <div id="bookTableModal" class="modal">
							<div class="modal-content">
								<span class="close-button">&times;</span>
								<form method="post" class="booking-form select-date-time-form" id="reservationForm" novalidate="novalidate">
									{% csrf_token %}
									<h2>Make a table reservation</h2>
									<div class="form-group">
										<p>Please select the number of people and the required date and time</p>
									</div>
									<div class="form-group">
										<input type="text" name="name" id="name" placeholder="Your Name" class="form-control required">
									</div>
									<div class="form-group">
										<input type="email" name="email" id="email" placeholder="Your Email" class="form-control required">
									</div>
									<div class="form-group">
										<input type="number" name="phone" id="phone" placeholder="Your Phone" class="form-control required">
									</div>
									<div class="form-group">
										<input type="text" id="BookingDate" class="form-control input datepicker checkin required" name="date" placeholder="Choose date">
									</div>									
									<div class="form-group">
										<select class="form-control required" id="BookingTime" name="time">
											<option value="">Select time</option>
											{% for slot in time_slots %}
												<option value="{{ slot }}">{{ slot }}</option>
											{% endfor %}
										</select>
									</div>
									<div class="form-group">
										<select name="member" id="Persons" class="form-control">
											<option value="1">1 person</option>
											<option selected value="2">2 people</option>
											<option value="3">3 people</option>
										</select>
									</div>
									<div class="form-group">
										<button class="btn-submit" type="submit">Next</button>
									</div>
								</form>
							</div>
						</div> {% endcomment %}
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- tabs -->
	{% comment %} <section class="tabs gap">
		<div class="container">
			<div class="tabs-img-back">
				<div class="row">
					<div class="col-lg-12">
						<div class="Provides" data-aos="fade-up" data-aos-delay="200" data-aos-duration="300">
							<div class="nav nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
								<button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill"
									data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home"
									aria-selected="true">Breakfast</button>
								<button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill"
									data-bs-target="#v-pills-profile" type="button" role="tab" aria-controls="v-pills-profile"
									aria-selected="false">Lunch</button>
								<button class="nav-link" id="v-pills-messages-tab" data-bs-toggle="pill"
									data-bs-target="#v-pills-messages" type="button" role="tab" aria-controls="v-pills-messages"
									aria-selected="false">Dinner</button>
							</div>
							<div class="like-meal">
								<a href=""><i class="fa-solid fa-heart"></i>Like Meals</a>
							</div>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="tab-content" id="v-pills-tabContent">
							<div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
								aria-labelledby="v-pills-home-tab">
								<div class="row">
									{% for menu in breakfast_items %}
										<div class="col-xl-4 col-lg-6" data-aos="flip-up" data-aos-delay="200" data-aos-duration="300">
											<div class="dish">
												<img alt="food-dish" class="img-fluid" src="{{ menu.cuisine.image.url }}">
												<div class="dish-foods">
													<h3>{{ menu.cuisine.title }}</h3>
													<div class="dish-icon">
														<div class="cafa-button">
															<a href="">{{ menu.keyword }}</a>
														</div>
														<div class="dish-icon end">
															<i class="info fa-solid fa-circle-info"></i>
															<div class="star">
																<a href=""><i class="fa-solid fa-heart"></i></a>
															</div>
														</div>
													</div>
													<div class="price">
														<h2>${{ menu.price }}</h2>
														<div class="qty-input">
															<button class="qty-count qty-count--minus" data-action="minus" type="button">-</button>
															<input class="product-qty" type="number" name="product-qty" min="0" value="1">
															<button class="qty-count qty-count--add" data-action="add" type="button">+</button>
														</div>
													</div>
													<button class="button-price">Add to Basket<i class="fa-solid fa-bag-shopping"></i></button>
												</div>
												<div class="dish-info" style="display: none;">
													<i class="info2 fa-solid fa-xmark"></i>
													<h5>{{ menu.cuisine.title }}</h5>
													<div class="cafa-button">
														<a href="">{{ menu.keyword }}</a>
													</div>
													<p>{{ menu.meta_description }}</p>
													<ul class="menu-dish">
														<li>{{ menu.meta_title }}</li>
													</ul>
												</div>
											</div>
										</div>
									{% endfor %}
								</div>
							</div>
							<div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
								<div class="row">
									{% for menu in lunch_items %}
										<div class="col-xl-4 col-lg-6">
											<div class="dish">
												<img alt="food-dish" class="img-fluid" src="{{ menu.cuisine.image.url }}">
												<div class="dish-foods">
													<h3>{{ menu.cuisine.title }}</h3>
													<div class="dish-icon">
														<div class="cafa-button">
															<a href="">{{ menu.keyword }}</a>
														</div>
														<div class="dish-icon end">
															<i class="info fa-solid fa-circle-info"></i>
															<div class="star">
																<a href=""><i class="fa-solid fa-heart"></i></a>
															</div>
														</div>
													</div>
													<div class="price">
														<h2>${{ menu.price }}</h2>
														<div class="qty-input">
															<button class="qty-count qty-count--minus" data-action="minus" type="button">-</button>
															<input class="product-qty" type="number" name="product-qty" min="0" value="1">
															<button class="qty-count qty-count--add" data-action="add" type="button">+</button>
														</div>
													</div>
													<button class="button-price">Add to Basket<i class="fa-solid fa-bag-shopping"></i></button>
												</div>
												<div class="dish-info" style="display: none;">
													<i class="info2 fa-solid fa-xmark"></i>
													<h5>{{ menu.cuisine.title }}</h5>
													<div class="cafa-button">
														<a href="">{{ menu.keyword }}</a>
													</div>
													<p>{{ menu.meta_description }}</p>
													<ul class="menu-dish">
														<li>{{ menu.meta_title }}</li>
													</ul>
												</div>
											</div>
										</div>
									{% endfor %}
								</div>
							</div>
							<!-- Dinner Tab -->
							<div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
								<div class="row">
									{% for menu in dinner_items %}
										<div class="col-xl-4 col-lg-6">
											<div class="dish">
												<img alt="food-dish" class="img-fluid" src="{% if menu.cuisine.image %}{{ menu.cuisine.image.url }}{% endif %} ">
												<div class="dish-foods">
													<h3>{{ menu.cuisine.title }}</h3>
													<div class="dish-icon">
														<div class="cafa-button">
															<a href="">{{ menu.keyword }}</a>
														</div>
														<div class="dish-icon end">
															<i class="info fa-solid fa-circle-info"></i>
															<div class="star">
																<a href=""><i class="fa-solid fa-heart"></i></a>
															</div>
														</div>
													</div>
													<div class="price">
														<h2>${{ menu.price }}</h2>
														<div class="qty-input">
															<button class="qty-count qty-count--minus" data-action="minus" type="button">-</button>
															<input class="product-qty" type="number" name="product-qty" min="0" value="1">
															<button class="qty-count qty-count--add" data-action="add" type="button">+</button>
														</div>
													</div>
													<button class="button-price">Add to Basket<i class="fa-solid fa-bag-shopping"></i></button>
												</div>
												<div class="dish-info" style="display: none;">
													<i class="info2 fa-solid fa-xmark"></i>
													<h5>{{ menu.cuisine.title }}</h5>
													<div class="cafa-button">
														<a href="">{{ menu.keyword }}</a>
													</div>
													<p>{{ menu.meta_description }}</p>
													<ul class="menu-dish">
														<li>{{ menu.meta_title }}</li>
													</ul>
												</div>
											</div>
										</div>
									{% endfor %}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>{% endcomment %}

	<section class="container">
		
	</section>
	
	
	<section class="tabs gap">
		<div class="container">
			<div class="">
				<div class="row">
					<div class="col-md-12 d-flex justify-content-end">
						<div class="switch-wrap pick_del">
							<label class="switch">
								<span id="delivery-option" class="switch-delivery active switch-ot" data-id="Delivery">
									Delivery
								</span>
								<span id="pickup-option" class="switch-pickup switch-ot" data-id="Pickup">
									Pickup
								</span>
							</label>
						</div>
					</div>
				</div>
				<div class="row mx-0 pt-4">
					<div class="col-lg-3 px-0 pe-md-2">
						<div class="dish h-100 mt-0">
							<h4 class="mb-4"><b>Categories</b></h4>
							<ul class="menu-categories list-unstyled">
								{% for category, cuisines in category_cuisines.items %}
									<li class="mb-3">
										<h4 class="text-secondary">
											<a href="{% url 'restaurant:restaurant-card-category' slug=restaurant.slug category_title=category %}"
											   style="{% if selected_category == category %}color: orange;{% endif %}">
												{{ category }}
											</a>
										</h4>
									</li>
								{% endfor %}
							</ul>
						</div>
					</div>
					<div class="col-lg-9 px-0 ps-md-2">
						<div class="dish mt-0">
							<h3 class="mb-4">Cuisines by Category: {{ selected_category|default:"All" }}</h3>
							<div class="row">
								{% if cuisines %}
									{% for cuisine in cuisines %}
										<div class="col-md-4 mt-3">
											<div class="card shadow-sm mb-4 h-100 hover-card">
												{% if cuisine.image %}
													<img src="{{ cuisine.image.url }}" class="card-img-top img-fluid" alt="{{ cuisine.title }}">
												{% endif %}
												<div class="card-body">
													<h5 class="card-title">{{ cuisine.title }}</h5>
													<p class="card-title">{{ cuisine.content | truncatechars:200 |safe }}</p>
				
													{% for food_item in cuisine.fooditems_cuisine.all %}
														<p class="card-text">
															<strong>Price:</strong> ${{ food_item.price }}<br>
															<strong>Available:</strong> {{ food_item.available|yesno:"Yes,No" }}<br>
															{% if food_item.start %}
																<strong>Start Time:</strong> {{ food_item.start|date:"H:i" }}<br>
															{% endif %}
															{% if food_item.end %}
																<strong>End Time:</strong> {{ food_item.end|date:"H:i" }}
															{% endif %}
														</p>
													{% endfor %}
													
													<button class="btn add-to-cart" style="background-color:#F29F05;" data-id="{{ cuisine.id }}" data-title="{{ cuisine.title }}" data-image="{{ cuisine.image.url }}">Add to Cart</button>
												</div>
											</div>
										</div>
									{% endfor %}
								{% else %}
									<p>No cuisines available for this category.</p>
								{% endif %}
							</div>
						</div>
					</div>                              
				</div>								
			</div>
		</div>
	</section>
   <!-- Lunch Section -->
   <section class="lunch-section gap" style="background:#fcfcfc">
    <div class="container">
        <h2 data-aos="fade-up" data-aos-delay="300" data-aos-duration="400">See also category Lunch</h2>
        <div class="row">
            {% for item in lunch_items %}
            <div class="col-xl-4 col-lg-6" data-aos="flip-up" data-aos-delay="200" data-aos-duration="300">
                <div class="dish">
                    <img alt="food-dish" src="{{ item.cuisine.image.url }}" class="img-fluid">
                    <div class="dish-foods">
                        <h3>{{ item.cuisine.title }}</h3>
                        <div class="dish-icon">
                            <div class="cafa-button">
                                <a href="javascript:void(0)">{{ item.cuisine.category.title }}</a>
                                {% comment %} <a href="">{{ item.cuisine.title }}</a> {% endcomment %}
                            </div>
                            <div class="dish-icon end">
                                <i class="info fa-solid fa-circle-info"></i>
                                <div class="star">
                                    <a href="javascript:void(0)"><i class="fa-solid fa-heart"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="price">
                            <h2>${{ item.price }}</h2>
                            <div class="qty-input">
                                <button class="qty-count qty-count--minus" data-action="minus" type="button">-</button>
                                <input class="product-qty" type="number" name="product-qty" min="0" value="1">
                                <button class="qty-count qty-count--add" data-action="add" type="button">+</button>
                            </div>
                        </div>
                        <button class="button-price">Add to Basket<i class="fa-solid fa-bag-shopping"></i></button>
                    </div>
                    <div class="dish-info" style="display: none;">
                        <i class="info2 fa-solid fa-xmark"></i>
                        <h5>{{ item.name }}</h5>
                        <div class="cafa-button">
                            <a href="javascript:void(0)">{{ item.cuisine.category.title }}</a>
                            <a href="javascript:void(0)">{{ item.cuisine.name }}</a>
                        </div>
                        <p>{{ item.description }}</p>
                        <ul class="menu-dish">
                            {% for feature in item.features %}
                            <li>{{ feature }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- footer -->
	
  <!-- bslthemes.com buttons html begin -->
  <div class="bsl-popup" data-theme="quickeat" data-category="html">
    <div class="bsl-popup__buttons"></div>
    <div class="bsl-popup__content bsl-popup__content-related">
      <div class="bsl-popup__menu"></div>
      <div class="bsl-popup__tabs">
        <div class="bsl-popup__tab bsl-popup__tab-demo"></div>
        <div class="bsl-popup__tab bsl-popup__tab-all"></div>
        <div class="bsl-popup__tab bsl-popup__tab-related"></div>
        <div class="bsl-popup__tab bsl-popup__tab-version"></div>
      </div>
    </div>
    <div class="bsl-popup__content bsl-popup__content-help"></div>
  </div>
  <!-- bslthemes.com buttons html end -->

  <!-- bslthemes.com buttons assets begin -->
  <link rel="stylesheet" href="https://bslthemes.com/bslthms-advanced-btns/assets/style.css">
  <!-- bslthemes.com buttons assets end -->
</div>
{% endblock %}

{% block script_js %}
<script>
	document.addEventListener("DOMContentLoaded", function() {
		const cart = [];
		
		document.querySelectorAll(".add-to-cart").forEach(button => {
			button.addEventListener("click", function() {
				console.log("Add to Cart button clicked"); // Debug line
				const menuId = this.getAttribute("data-id");
				const menuTitle = this.getAttribute("data-title");
				const menuPrice = parseFloat(this.getAttribute("data-price"));
				
				const existingItem = cart.find(item => item.id === menuId);
				if (existingItem) {
					existingItem.quantity += 1;
				} else {
					cart.push({ id: menuId, title: menuTitle, price: menuPrice, quantity: 1 });
				}
				
				updateCartDisplay();
				document.querySelector("#cart-section").classList.add("show");
			});
		});
	
		function updateCartDisplay() {
			const cartIcon = document.querySelector("#desktop-menu i");
			cartIcon.textContent = `(${cart.length})`;  
			const cartContent = document.querySelector("#cart-content #cart-items");
			cartContent.innerHTML = ""; 
	
			cart.forEach(item => {
				const cartItem = document.createElement("div");
				cartItem.classList.add("cart-item");
				cartItem.innerHTML = `
					<p>${item.title} - $${item.price} x ${item.quantity}</p>
					<button class="btn btn-sm btn-primary increase-qty" data-id="${item.id}">+</button>
				`;
				cartContent.appendChild(cartItem);
			});
		}
	});
</script>
<script>
		document.addEventListener("DOMContentLoaded", function() {
		const modal = document.getElementById("bookTableModal");
		const btn = document.getElementById("bookTableButton");
		const span = document.getElementsByClassName("close-button")[0];
		btn.onclick = function() {
			modal.style.display = "block";
		}
		span.onclick = function() {
			modal.style.display = "none";
		}
		window.onclick = function(event) {
			if (event.target == modal) {
				modal.style.display = "none";
			}
		}
	});
</script>
<script>
	function displayDistances() {
		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position) {
				const userLat = position.coords.latitude;
				const userLon = position.coords.longitude;
	
				document.querySelectorAll('.restaurant-card').forEach(function(card) {
					const restaurantLat = parseFloat(card.getAttribute('data-latitude'));
					const restaurantLon = parseFloat(card.getAttribute('data-longitude'));
	
					const distance = calculateDistance(userLat, userLon, restaurantLat, restaurantLon);
					card.querySelector('.distance').innerText = `Distance: ${distance.toFixed(2)} km`;
	
					// Store the delivery charge based on the distance
					let deliveryCharge = 0;
					if (distance > 7) {
						deliveryCharge = distance * 1; // Charge $1 per km for the entire distance
					}
					card.setAttribute('data-delivery-charge', deliveryCharge.toFixed(2));
				});
			});
		} else {
			console.error("Geolocation is not supported by this browser.");
		}
	}
	
	document.addEventListener('DOMContentLoaded', displayDistances);
	
</script>
<script>
	document.addEventListener('DOMContentLoaded', function() {
    const deliveryOption = document.getElementById('delivery-option');
    const pickupOption = document.getElementById('pickup-option');
	const voucherInput = document.getElementById('voucher-code');
    const applyVoucherBtn = document.getElementById('apply-voucher');
    const deliveryCharge = 19;
    let orderType = 'Delivery'; 


    function activateOption(selectedOption) {
        orderType = selectedOption;
        if (selectedOption === 'Delivery') {
            deliveryOption.classList.add('active');
            pickupOption.classList.remove('active');
        } else if (selectedOption === 'Pickup') {
            pickupOption.classList.add('active');
            deliveryOption.classList.remove('active');
        }
        updateCartDisplay();
        console.log(`Selected option: ${selectedOption}`);
    }

    deliveryOption.addEventListener('click', function() {
        activateOption('Delivery');
    });

    pickupOption.addEventListener('click', function() {
        activateOption('Pickup');
    });

    const cart = [];
    document.querySelectorAll(".add-to-cart").forEach(button => {
        button.addEventListener("click", function() {
            console.log("Add to Cart button clicked"); 
            const menuId = this.getAttribute("data-id");
            const menuTitle = this.getAttribute("data-title");
            const menuPrice = parseFloat(this.getAttribute("data-price"));
            const menuImage = this.getAttribute("data-image");

            const existingItem = cart.find(item => item.id === menuId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id: menuId, title: menuTitle, price: menuPrice, image: menuImage, quantity: 1 });
            }

            updateCartDisplay();
        });
    });
	applyVoucherBtn.addEventListener("click", function() {
        const voucherCode = voucherInput.value.trim();
        if (voucherCode) {
            // For demo purposes, we'll just apply a fixed discount
            // In a real application, you might need to validate the voucher code via an API call
            voucherDiscount = 10.00; // Example discount
        } else {
            voucherDiscount = 0;
        }
        updateCartDisplay();
    });

	function updateCartDisplay() {
		const cartIcon = document.querySelector("#desktop-menu i");
		cartIcon.textContent = `(${cart.length})`;  
	
		const cartContent = document.querySelector("#cart-content #cart-items");
		cartContent.innerHTML = "";  
	
		let totalAmount = 0;
		cart.forEach(item => {
			totalAmount += item.price * item.quantity;
	
			const cartItem = document.createElement("div");
			cartItem.classList.add("cart-item");
			cartItem.innerHTML = `
				<img src="${item.image}" alt="${item.title}" class="cart-item-image">
				<p>${item.title} - $${item.price} x ${item.quantity}</p>
				<div>
					<button class="btn btn-sm btn-primary increase-qty" data-id="${item.id}">+</button>
					<button class="btn btn-sm btn-danger decrease-qty" data-id="${item.id}">-</button>
				</div>
			`;
			cartContent.appendChild(cartItem);
		});
	
		if (orderType === 'Delivery') {
			// Assuming that the selected restaurant is the first one in the cart for simplicity
			const selectedRestaurantCard = document.querySelector('.restaurant-card'); 
			const deliveryCharge = parseFloat(selectedRestaurantCard.getAttribute('data-delivery-charge')) || 0;
			totalAmount += deliveryCharge;
	
			const deliveryChargeItem = document.createElement("div");
			deliveryChargeItem.classList.add("cart-item");
			deliveryChargeItem.innerHTML = `<p>Delivery Charge: $${deliveryCharge.toFixed(2)}</p>`;
			cartContent.appendChild(deliveryChargeItem);
		}
	
		const totalAmountItem = document.createElement("div");
		totalAmountItem.classList.add("cart-item");
		totalAmountItem.innerHTML = `<p>Total: $${totalAmount.toFixed(2)}</p>`;
		cartContent.appendChild(totalAmountItem);
	
		// document.querySelector("#cart-section").classList.add("show");
	
		document.querySelectorAll(".increase-qty").forEach(button => {
			button.addEventListener("click", function() {
				const itemId = this.getAttribute("data-id");
				const item = cart.find(cartItem => cartItem.id === itemId);
				if (item) {
					item.quantity += 1;
					updateCartDisplay();
				}
			});
		});
	
		document.querySelectorAll(".decrease-qty").forEach(button => {
			button.addEventListener("click", function() {
				const itemId = this.getAttribute("data-id");
				const item = cart.find(cartItem => cartItem.id === itemId);
				if (item) {
					if (item.quantity > 1) {
						item.quantity -= 1;
					} else {
						const index = cart.findIndex(cartItem => cartItem.id === itemId);
						if (index > -1) {
							cart.splice(index, 1);
						}
					}
					updateCartDisplay();
				}
			});
		});
	}

    document.querySelector("#desktop-menu").addEventListener("click", function() {
        document.querySelector("#cart-section").classList.toggle("show");
    });

    document.querySelector("#close-cart").addEventListener("click", function() {
        document.querySelector("#cart-section").classList.remove("show");
    });
});

</script>
<script>
	
	document.addEventListener('DOMContentLoaded', function() {
		flatpickr("#BookingDate", {
			dateFormat: "Y-m-d",
			minDate: "today",
		});
	});
</script>
<script>
var modal = document.getElementById("infoModal");
var btn = document.getElementById("openModal");
var span = document.getElementById("closeModal");
btn.onclick = function() {
  modal.style.display = "block";
}
span.onclick = function() {
  modal.style.display = "none";
}
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

</script>
<script>
var feedbackModal = document.getElementById("feedbackModal");
var feedbackBtn = document.getElementById("openFeedbackModal");
var feedbackClose = document.getElementById("closeFeedbackModal");
feedbackBtn.onclick = function() {
  feedbackModal.style.display = "block";
}
feedbackClose.onclick = function() {
  feedbackModal.style.display = "none";
}
window.onclick = function(event) {
  if (event.target == feedbackModal) {
    feedbackModal.style.display = "none";
  }
}

</script>
<script>
	document.addEventListener('DOMContentLoaded', function () {
		const form = document.getElementById('reservationForm');
		const submitButton = form.querySelector('.btn-submit');
	
		const fields = form.querySelectorAll('.form-control.required');
	
		fields.forEach(function(field) {
			field.addEventListener('input', function () {
				validateForm();
			});
		}); 
	
		function validateForm() {
			let allFieldsFilled = true;
			fields.forEach(function(field) {
				if (!field.value.trim()) {
					allFieldsFilled = false;
				}
			});
	
			submitButton.disabled = !allFieldsFilled;
		}
		validateForm();
		const phoneInput = document.getElementById('phone');
		phoneInput.addEventListener('input', function (e) {
			this.value = this.value.replace(/[^0-9]/g, ''); 
		});
	});
</script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></>

{% endblock %}