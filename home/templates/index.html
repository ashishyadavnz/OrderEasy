{% load static %}
{% load custom_filter %}
<!DOCTYPE html>
<html class="wide wow-animation" lang="en">

<head>
	<title>Order Easy</title>
	<meta name="description" content="Order Easy"/>
	<meta name="keywords" content="Order Easy" />
	<meta name="viewport" content="width=device-width height=device-height initial-scale=1.0">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="icon" href="{% static 'images/order-easy.png' %}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
	<link rel="stylesheet" href="https://bslthemes.com/bslthms-advanced-btns/assets/style.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<!-- CSS only -->
	<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
	<link rel="stylesheet" href="{% static 'css/own.css' %}">
	<link rel="stylesheet" href="{% static 'css/own-car.css' %}">
	<link rel="stylesheet" href="{% static 'css/nice.css' %}">
	<link rel="stylesheet" href="{% static 'css/color.css' %}">
	<link rel="stylesheet" href="{% static 'css/aos.css' %}">
	<link rel="stylesheet" href="{% static 'css/new.css' %}">
	<link rel="stylesheet" href="{% static 'css/custom.css' %}">
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAJyohCbfGZAjBsj2HddGPlY3YjwJ3i1To&libraries=places"></script>

	<style>
		.cart-drop.show {
			opacity: var(--bs-backdrop-opacity);
		}
		.cart-drop {
			--bs-backdrop-zindex: 1050;
			--bs-backdrop-bg: #000;
			--bs-backdrop-opacity: 0.5;
			position: fixed;
			top: 0;
			left: 0;
			z-index: 500;
			width: 100vw;
			height: 100vh;
			background-color: var(--bs-backdrop-bg);
			display: none;
		}
	</style>
	{% block schema %}{% endblock %}
</head>

<body style="word-wrap: break-word;">
	<div class="page-loader">
		<div class="wrapper">
			<div class="circle"></div>
			<div class="circle"></div>
			<div class="circle"></div>
			<div class="shadow"></div>
			<div class="shadow"></div>
			<div class="shadow"></div>
			<span>Loading</span>
		</div>
	</div>
	<header class="pb-0 fixed-header">
		<div class="{% if user_address %}mx-md-5{% else %}container{% endif %}">
			<div class="d-flex align-items-center justify-content-between  mx-0">
				<div class="">
					<div class="header-style">
						<a href="{% url 'home:home-page' %}">
							<img src="{% static 'images/order-easy.png' %}" class="img-fluid log-imag" alt="logo.png"
								height="150px" width="200px">
						</a>
						<div class="extras bag">
							<a href="javascript:void(0)" class="menu-btn">
								<i class="fa-solid fa-bag-shopping"></i>
							</a>
							<div>
								<i class="fa-solid fa-bars"></i>
							</div>
						</div>
					</div>
				</div>
				<div id="navbar-container" class="d-flex align-items-center ">
					<nav class="navbar">
						<ul class="navbar-links">
							<li class="navbar-dropdown {% if request.resolver_match.url_name == 'home-page' %}active{% endif %}">
								<a href="{% url 'home:home-page' %}">Home</a>
							</li>
							{% if request.user and request.user.role == 'Owner' %}
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'my_restaurant' %}active{% endif %}">
								<a href="{% url 'restaurant:my_restaurant' %}">My Restaurants</a>
							</li>
							{% else %}
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'restaurant' %}active{% endif %}">
								<a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
							</li>
							{% endif %}
							<li class="navbar-dropdown {% if request.resolver_match.url_name == 'blog_page' %}active{% endif %}">
								<a href="{% url 'blog:blog_page' %}">Blog</a>
							</li>
							<li class="navbar-dropdown {% if request.resolver_match.url_name == 'about-page' %}active{% endif %}">
								<a href="{% url 'home:about-page' %}">About Us</a>
							</li>

							<!-- <li class="navbar-dropdown">
								<a href="JavaScript:void(0)">Pages</a>
								<div class="dropdown">
									<a href="{% url 'blog:blog_page' %}">Blog</a>
									<a href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single Blog</a>
									<a href="{% url 'blog:service' %}">Services</a> 
									<a href="{% url 'home:faq' %}">FAQ</a>
									<a href="{% url  'home:pricing-table'  %}">Pricing Table</a>
									<a href="{% url  'home:become-partner'  %}">Become A Partner</a>
									<a href="{% url  'home:page-not-found'  %}">404</a>
								</div>
							</li> -->
							<li class="navbar-dropdown {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
								<a href="{% url  'home:contact'  %}">Contact</a>
							</li>
							{% if request.user.is_authenticated %}
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
								<a href="{% url  'home:profile'  %}">Profile</a>
							</li>
							{% endif %}
							{% if request.user.is_authenticated %}
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
								<a href="{% url 'home:myorder' %}">My Orders</a>
							</li>
							{% endif %}

						</ul>
					</nav>
				</div>
				<div id="web" class="d-flex justify-content-between align-items-center">
					<div class="d-flex align-items-center ">
						{% if user_address %}
						<!-- <div class="d-flex align-items-center">
							<div class="mx-3 px-5 fs-4 border border-warning	 rounded-3 d-flex align-items-center ">
								<i class="fa-solid fa-location-dot me-2 text-danger"></i>
								<span>{{user_address.add}}</span>
							</div>
						</div> -->
						<form class="d-flex align-items-center w-md-80" id="location-form-2" method="post"
							action="{% url 'restaurant:restaurant' %}">
							{% csrf_token %}
							<!-- <div class="d-flex align-items-center"> -->
							<div class="input-group">
								<span class="input-group-text mt-2 bg-white" id="basic-addon1">
									<i class="fa-solid fa-location-dot text-danger"></i>
								</span>
									<input required type="text" id="location-input-2" name="location" value="{{ user_address.display }}" class="form-control me-5 mt-2 location-input-2 " placeholder="Enter your address...">
							</div>
							<!-- </div> -->
							<input type="hidden" id="address-2" name="address">
							<input type="hidden" id="latitude-2" name="latitude">
							<input type="hidden" id="longitude-2" name="longitude">
							<input type="hidden" name="checkout_add" value="true">
						</form>
						{% endif %}
						{% if request.user and request.user.role == 'Owner' %}
						{% else %}
						<div class="extras bag">
							<a href="javascript:void(0)" id="desktop-menu" class="menu-btn p-2">
									<i class="fa-solid fa-bag-shopping px-2">&nbsp;<span id="cart-total-amount">$ 0</span></i>
							</a>
							<!-- Cart Section -->
							<!-- <a href="{% url 'restaurant:restaurant' %}" class="button button-2">Order Now</a> -->
						</div>
						{% endif %}

						<div class="bag">
							{% if user.is_authenticated %}
							<a href="{% url 'home:logout' %}" class="button button-2 text-nowrap">Logout</a>
							{% else %}
							<a href="{% url 'home:login' %}" class="button button-2 text-nowrap">Sign In</a>
							{% endif %}
						</div>
					</div>
				</div>
				<div class="side-menu" id="content" style="display: none;">
					<button  onclick="toggleVisibility()" class="border-0" style="float: right !important; background-color: none;">
						<i class="fa-solid fa-close" aria-hidden="true" style=" color: #F29F05 ;"></i>
					</button>
					<nav class="navbar">
						<ul class="">
							<a href="{% url 'home:home-page' %}">
								<img src="{% static 'images/order-easy.png' %}" class="img-fluid log-imag" alt="logo.png"
									height="100px" width="150px">
							</a>
							<li class="navbar-dropdown active">
								<a href="{% url 'home:home-page' %}">Home</a>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="{% url 'home:about-page' %}">About Us</a>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="javascript:void(0)" class="dropdown-toggle">Restaurants</a>
								<div class="dropdown-content">
									<a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
									{% if restaurants and restaurants.first %}
									<a href="{% url 'restaurant:restaurant-card' slug=restaurants.first.slug %}">Restaurant Card</a>
									{% else %}
									<a href="">Restaurant Card</a>
									{% endif %}
									<a href="{% url  'home:checkout'  %}">Checkout</a>
								</div>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="javascript:void(0)" class="dropdown-toggle">Pages</a>
								<div class="dropdown-content">
									<a href="{% url 'blog:blog_page' %}">Blog</a>
									<a href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single Blog</a>
									<a href="{% url  'blog:service'  %}">Services</a>
									<a href="{% url 'home:faq' %}">FAQ</a>
									<a href="{% url  'home:pricing-table'  %}">Pricing Table</a>
									<a href="{% url  'home:become-partner'  %}">Become A Partner</a>
									<a href="{% url  'home:page-not-found'  %}">404</a>
								</div>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="{% url  'home:contact'  %}">Contact</a>
							</li>
							{% if request.user.is_authenticated %}
							<hr>
							<li class="navbar-dropdown">
								<a href="{% url  'home:profile'  %}">Profile</a>
							</li>
							{% endif %}
							<hr>
						</ul>
					</nav>
				</div>
				<div id="mobile" style="display: none;" class=" col-4 justify-content-end">
					<div class="extras bag d-flex">
						<a href="javascript:void(0)" id="desktop-menu" class="menu-btn">
							<i class="fa-solid fa-bag-shopping px-2"></i>
						</a>
						<button  onclick="toggleVisibility()" class="border-0" style="background-color: transparent !important;">
							<i class="fa-solid fa-bars" aria-hidden="true"></i>
						</button>
					</div>
				</div>
				<div class="menu-wrap d-none">
					<div class="menu-inner ps ps--active-x ps--active-y">
						<span class="menu-cls-btn"><i class="cls-leftright"></i><i class="cls-rightleft"></i></span>
						<div class="checkout-order">
							<div class="title-checkout">
								<h2>My Orders</h2>
							</div>
							<div class="banner-wilmington">
								<img alt="logo" src="https://bslthemes.com/html/quickeat/assets/img/logo-s.jpg">
								<h6>Kennington Lane Cafe</h6>
							</div>
							<ul>
								<li class="price-list">
									<i class="closeButton fa-solid fa-xmark"></i>
									<div class="counter-container">
										<div class="counter-food">
											<img alt="food"
												src="https://bslthemes.com/html/quickeat/assets/img/dish-6.png">
											<h4>Pasta, kiwi and sauce chilli</h4>
										</div>
										<h3>$39</h3>
									</div>
									<div class="price">
										<div>
											<h2>$39</h2>
											<span>Sum</span>
										</div>
										<div>
											<div class="qty-input">
												<button class="qty-count qty-count--minus" data-action="minus"
													type="button">-</button>
												<input class="product-qty" type="number" name="product-qty" min="0"
													value="1">
												<button class="qty-count qty-count--add" data-action="add"
													type="button">+</button>
											</div>
											<span>Quantity</span>
										</div>
									</div>
								</li>
								<li class="price-list">
									<i class="closeButton fa-solid fa-xmark"></i>
									<div class="counter-container">
										<div class="counter-food">
											<img alt="food"
												src="https://bslthemes.com/html/quickeat/assets/img/dish-7.png">
											<h4>Rice with shrimps and kiwi</h4>
										</div>
										<h3>$49</h3>
									</div>
									<div class="price">
										<div>
											<h2>$49</h2>
											<span>Sum</span>
										</div>
										<div>
											<div class="qty-input">
												<button class="qty-count qty-count--minus" data-action="minus"
													type="button">-</button>
												<input class="product-qty" type="number" name="product-qty" min="0"
													value="1">
												<button class="qty-count qty-count--add" data-action="add"
													type="button">+</button>
											</div>
											<span>Quantity</span>
										</div>
									</div>
								</li>
							</ul>
							<div class="totel-price">
								<span>Total order:</span>
								<h5>$137</h5>
							</div>
							<div class="totel-price">
								<span>To pay:</span>
								<h2>$137</h2>
							</div>
							<button class="button-price">Checkout</button>

						</div>
					</div>
				</div>
				<div class="mobile-nav hmburger-menu" id="mobile-nav" style="display:block;">
					<div class="res-log">
						<a href="{% url 'home:home-page' %}">
							<svg xmlns="http://www.w3.org/2000/svg" width="163" height="38" viewBox="0 0 163 38">
								<g id="Logo-m" transform="translate(-260 -51)">
									<g id="Logo-2-m" data-name="Logo" transform="translate(260 51)">
										<g id="Elements-m">
											<path id="Path_3429" data-name="Path 3429"
												d="M315.086,140.507H275.222v-.894c0-11.325,8.941-20.538,19.933-20.538s19.931,9.213,19.931,20.538Z"
												transform="translate(-270.155 -115.396)" fill="#f29f05" />
											<path id="Path_3430" data-name="Path 3430"
												d="M301.13,133.517a1.488,1.488,0,0,1-1.394-.994,11.361,11.361,0,0,0-10.583-7.54,1.528,1.528,0,0,1,0-3.055,14.353,14.353,0,0,1,13.37,9.527,1.541,1.541,0,0,1-.875,1.966A1.444,1.444,0,0,1,301.13,133.517Z"
												transform="translate(-264.176 -113.935)" fill="#fff" />
											<path id="Path_3431" data-name="Path 3431"
												d="M297.343,146.544a14.043,14.043,0,0,1-13.837-14.211h2.975a10.865,10.865,0,1,0,21.723,0h2.975A14.043,14.043,0,0,1,297.343,146.544Z"
												transform="translate(-266.247 -108.544)" fill="#363636" />
											<path id="Path_3432" data-name="Path 3432"
												d="M302.183,132.519a7.064,7.064,0,1,1-14.122,0Z"
												transform="translate(-264.027 -108.446)" fill="#363636" />
											<path id="Path_3433" data-name="Path 3433"
												d="M320.332,134.575H273.3a1.528,1.528,0,0,1,0-3.055h47.033a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-271.815 -108.923)" fill="#f29f05" />
											<path id="Path_3434" data-name="Path 3434"
												d="M289.154,123.4a1.507,1.507,0,0,1-1.487-1.528v-3.678a1.488,1.488,0,1,1,2.975,0v3.678A1.508,1.508,0,0,1,289.154,123.4Z"
												transform="translate(-264.154 -116.667)" fill="#f29f05" />
											<path id="Path_3435" data-name="Path 3435"
												d="M284.777,138.133H275.3a1.528,1.528,0,0,1,0-3.055h9.474a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-270.84 -107.068)" fill="#363636" />
											<path id="Path_3436" data-name="Path 3436"
												d="M284.8,141.691h-6.5a1.528,1.528,0,0,1,0-3.055h6.5a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-269.379 -105.218)" fill="#363636" />
										</g>
									</g>
									<text id="Quickeat-m" transform="translate(320 77)" fill="#363636" font-size="20"
										font-family="Poppins" font-weight="700">
										<tspan x="0" y="0">QUICK</tspan>
										<tspan y="0" fill="#f29f05">EAT</tspan>
									</text>
								</g>
							</svg>
						</a>
					</div>
					<ul>
						<li><a href="{% url 'home:home-page' %}">Home</a></li>
						{% if request.user and request.user.role == 'Owner' %}
						<li>
							<a href="{% url 'restaurant:my_restaurant' %}">My Restaurants</a>
						</li>
						{% else %}
						<li>
							<a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
						</li>
						{% endif %}
						<li>
							<a href="{% url 'blog:blog_page' %}">Blog</a>
						</li>
						<li><a href="{% url 'home:about-page' %}">About Us</a></li>
						<!-- <ul class="sub-menu">
								<li><a href="{% url 'restaurant:restaurant' %}">Restaurants</a></li>
								<li>     {% if restaurants and restaurants.first %}
									<a href="{% url 'restaurant:restaurant-card' slug=restaurants.first.slug %}">Restaurant Card</a>
								{% else %}
									<a href="">Restaurant Card</a> 
								{% endif %}
								</li>
								<li><a href="{% url  'home:checkout'  %}">Checkout</a></li>
							</ul> -->
						</li>
						{% comment %}
						<li class="menu-item-has-children"><a href="JavaScript:void(0)">Pages</a>
							<ul class="sub-menu">
								<li><a href="{% url 'blog:blog_page' %}">Blog</a></li>
								<li><a
										href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single
										Blog</a>
								</li>
								<li><a href="{% url  'blog:service'  %}">Services</a></li>
								<li><a href="{% url 'home:faq' %}">FAQ</a></li>
								<li><a href="{% url  'home:pricing-table'  %}">Pricing Table</a></li>
								<li><a href="{% url  'home:become-partner'  %}">Become A Partner</a></li>
								<li><a href="{% url  'home:page-not-found'  %}">404</a></li>
							</ul>
						</li>
						{% endcomment %}
						<li><a href="{% url  'home:contact'  %}">Contact</a></li>
						{% if request.user.is_authenticated %}
						<li><a href="{% url  'home:profile'  %}">Profile</a></li>
						{% endif %}
					</ul>
					<a href="JavaScript:void(0)" id="res-cross"></a>
				</div>
			</div>
		</div>
		{% if messages %}
		<div class="messages">
			{% for message in messages %}
			<div class="alert {% if message.tags == 'error' %}alert-danger{% else %}alert-{{ message.tags }}{% endif %} alert-dismissible fade show" role="alert">
				{{ message }}
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
			{% endfor %}
		</div>
		{% endif %}
	</header>
	<div class="cart-drop fade show"></div>
	<div id="cart-section" class="cart-sidebar">
		<div class="cart-header">
			<h2>My Cart</h2>
			<button id="close-cart" class="btn btn-info">Close</button>
		</div>
		<form id="cart-form" method="POST" action="{% url 'home:checkout' %}">
			{% csrf_token %}
			<div id="cart-content">
				<div class="cart-items"></div>
				<input type="hidden" id="order-type-input" name="order_type" value="Delivery">
				<input type="hidden" id="restaurent-input" name="restaurent_id">
				<input type="hidden" id="dcharge" name="charge">
				<input type="hidden" id="voucher_id" name="voucher_id">
				<div class="omc-sv">
					<!-- <div class="voucher-code voucher-section mt-4">
						<input type="text" name="VoucherCode" id="voucher-code"
							class="form-control om-voucher-code" placeholder="Enter voucher code" data-sid="1166">
						<button class="btn add-voucher" id="apply-voucher">Add</button>
					</div> -->
				</div>
				<input type="hidden" name="cart_data" id="cart-data">
				<div class="cart-footer">
					<p id="total-amount"></p>
					<button type="submit" id="checkout" name="cart_checkout" class="btn btn-success">Checkout</button>
				</div>
			</div>
		</form>
	</div>

	{% block content %}

	{% endblock %}
	<footer class="gap no-bottom" style="background-color: #363636;">
		<div class="container">
			<div class="row mx-0">
				<div class="col-lg-5 col-md-6 col-sm-12">
					<div class="footer-description" style="word-wrap: break-word;">
						<a href="{% url 'home:home-page' %}">
							<img src="{% static 'images/order-easy.png' %}" alt="logo.png" class="foot-img" height="150px">
						</a>
						<h2>The Best Restaurants
							in Your Home</h2>
						<!-- <p>Vitae congue mauris rhoncus aenean. Enim nulla
							aliquet porttitor lacus luctus accumsan
							tortor posuere. Tempus egestas sed sed risus pretium quam.</p> -->
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<div class="menu">
						<h4>Menu</h4>
						<ul class="footer-menu">
							<li><a href="{% url 'home:home-page' %}">home<i class="fa-solid fa-arrow-right"></i></a>
							</li>
							<li><a href="{% url 'home:about-page' %}">About us<i
										class="fa-solid fa-arrow-right"></i></a></li>
							<li><a href="{% url 'restaurant:restaurant' %}">Restaurants<i
										class="fa-solid fa-arrow-right"></i></a></li>
							<li><a href="{% url  'home:contact'  %}">Contact<i class="fa-solid fa-arrow-right"></i></a>
								<!-- <li><a href="{% url 'home:faq' %}">FAQ's<i class="fa-solid fa-arrow-right"></i></a> -->
							</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 col-sm-12">
					<div class="menu contacts">
						<h4>Contacts</h4>
						<!-- <div class="footer-location">
							<i class="fa-solid fa-location-dot"></i>
							<p>1717 Harrison St, San Francisco, CA 94103,
								United States</p>
						</div> -->
						<a href="mailto:ordereasynz@gmail.com"><i class="fa-solid fa-envelope"></i>ordereasynz@gmail.com</a>
						<a href="callto:+64212477475"><i class="fa-solid fa-phone"></i>+64212477475</a>
					</div>
					<ul class="social-media">
						<li><a href="javascript:void(0)"><i class="fa-brands fa-facebook-f"></i></a></li>
						<li><a href="javascript:void(0)"><i class="fa-brands fa-instagram"></i></a></li>
						<li><a href="javascript:void(0)"><i class="fa-brands fa-twitter"></i></a></li>
					</ul>
				</div>
			</div>
			<div class="footer-two gap no-bottom">
				<p>Copyright Â© {% now "Y" %}. OrderEasy. All rights reserved.</p>
				<div class="privacy">
					{% if 'privacy-policy'|is_page %}
					<a href="{% url 'home:page_detail' 'privacy-policy' %}">Privacy Policy</a>
					{% endif %}
					{% if 'terms-conditions'|is_page %}
					<a href="{% url 'home:page_detail' 'terms-conditions' %}">Terms & Conditions</a>
					{% endif %}
				</div>
			</div>
		</div>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
		crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
	<script src="{% static 'js/fast.js' %}"></script>
	<script src="{% static 'js/eat.js' %}"></script>
	<script src="{% static 'js/aos.js' %}"></script>
	<script src="{% static 'js/custom.js' %}"></script>
	<script src="{% static 'js/ownchar.js' %}"></script>
	<script type="module">
		import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
		import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-messaging.js";

		const firebaseConfig = {
			apiKey: "AIzaSyBZgRCZexv8ErSYGyo6IpbO1Q438e-CFTA",
			authDomain: "timestint-st.firebaseapp.com",
			projectId: "timestint-st",
			storageBucket: "timestint-st.appspot.com",
			messagingSenderId: "507688135519",
			appId: "1:507688135519:web:1b3a39ef85863310fce4ea",
			measurementId: "G-6XJ70609DK"
		};

		const app = initializeApp(firebaseConfig);
		const messaging = getMessaging();

		getToken(messaging, { vapidKey: 'BHzwzJsxsIu-lTCvdZQfK1eqfCJd1tqDzGySY9DEjX6CwlZA1LB42062q2bv9uH3B2R18H_TVxbGVZl9X0yZjwI' }).then((currentToken) => {
			if (currentToken) {
				sendTokenToServer(currentToken);
                // console.log("Token is: ", currentToken);
			} else {
                // console.log('No registration token available. Request permission to generate one.');
			}
		}).catch((err) => {
            // console.log('An error occurred while retrieving token: ', err);
		});

		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('js/firebase-messaging-sw.js')
            .then(function(registration) {
                // console.log('Service Worker registered with scope:', registration.scope);
            }).catch(function(err) {
                // console.log('Service Worker registration failed:', err);
				});
		}
	</script>
	{% block script_js %}
	{% endblock %}
	<script>
		function cartupdate(res) {
			// localStorage.setItem('distance', res['distance']);
			var cartsection = $('#cart-section');
			var cart = res['cart'];
			cartsection.find('.cart-items .cart-item').remove();
			$('.add-to-cart').show();
			$('.decrease-qty, .increase-qty, .item-quantity').addClass('d-none');
			$("#cart-total-amount").text('$0');
			if (cart.length > 0) {
				cartsection.find('input[name="order_type"]').val(cart[0]['order_type']);
				cartsection.find('input[name="restaurent_id"]').val(cart[0]['restaurant']);
				cartsection.find('input[name="cart_data"]').val(JSON.stringify(cart));
				$("#checkout").show();
				$(".cart-items").show();
			}
			else {
				$("#checkout").hide();
				$(".cart-items").hide();
			}
			for (let i = 0; i < cart.length; i++) {
				var itemCard = $(".carditem" + cart[i].item_id);
				if (itemCard) {
					if (cart[i].quantity > 0) {
						itemCard.siblings('.add-to-cart').hide();
						itemCard.siblings('.decrease-qty, .increase-qty, .item-quantity').removeClass('d-none');
					} else {
						itemCard.siblings('.add-to-cart').show();
						itemCard.siblings('.decrease-qty, .increase-qty, .item-quantity').addClass('d-none');
					}
					itemCard.siblings('.item-quantity').text('Qty: ' + cart[i].quantity);
				}
				var html = `
					<div class="cart-item" data-id="{{item.id}}"><div class="container">
						<div class="row">
							<div class="col-md-3">
								<img src="${cart[i].image}" alt="${cart[i].title}" class="cart-item-image" loading="lazy">
							</div>
							<div class="col-md-5 pt-2" style="text-align: center;">
								<p style="font-size:20px"><strong>${cart[i].title}</strong></p>
							</div>
							<div class="col-md-2 pt-2" style="text-align: center;">
								<p style="font-size:20px"><strong>$${cart[i].price} x <span class="cart-item-quantity">${cart[i].quantity}</span></strong></p>
							</div>
							<div class="col-md-2 float-right">
								<a class="btn decrease-qty" data-resid="${cart[i].restaurant}" data-id="${cart[i].item_id}">-</a>
								<a class="btn increase-qty me-2" data-resid="${cart[i].restaurant}" data-id="${cart[i].item_id}">+</a>
							</div>
						</div>
					</div>
				`;
				cartsection.find('.cart-items').append(html);
			}
			let totalAmount = 0;
			cart.forEach(item => {
				totalAmount += item.price * item.quantity;
			});
			var dist = parseFloat(res['distance']);
			if (res['type'] == 'Delivery') {
				if (totalAmount < 30) {
					if ("{{restaurant.vip}}" === "True") {
						deliveryCharge = 15 + dist;
					} else {
						deliveryCharge = dist;
					}
				} else if (dist > 7) {
					if ("{{restaurant.vip}}" === "True") {
						deliveryCharge = 15 + dist;
					} else {
						deliveryCharge = dist;
					}
				} else {
					deliveryCharge = 0;
				}
			} else {
				deliveryCharge = 0;
			}
			cartsection.find('input[name="charge"]').val(deliveryCharge.toFixed(2));
			final = (totalAmount + deliveryCharge).toFixed(2);
			var dcharge_html = `<div class="cart-item">
				<p class="dcharge">Delivery Charge: <span>$${deliveryCharge.toFixed(2)}</span></p>
			</div>`
			var total_html = `<div class="cart-item price-div">
				<p class="dtotal">Total: <span>$${final}</span></p>
				</div>`
			cartsection.find('.cart-items').append(dcharge_html);
			cartsection.find('.cart-items').append(total_html);
			var voucher = res['voucher']
			if (voucher) {
				total = parseInt(voucher['total']);
				$('#cart-section').find(".dtotal").find('span').text(voucher['total']);
				$("#apply-voucher").attr("disabled", true);
				$("#voucher-code").attr("disabled", true);
				$("#voucher-code").val(voucher['name']);
				$("#voucher_id").val(voucher['id']);
				var voucher_html = `<div class="cart-item">
					<p class="dcharge">Voucher Charge: - <span>${voucher['discount']}</span></p>
				</div>`
				$('#cart-section').find(".price-div").before(voucher_html);
			}
			$("#cart-total-amount").text('$' + parseFloat(final).toFixed(2));
		}
	</script>
	<script>
		window.onload = function(e) {
			var item_id = $(this).data("id");
			$.ajax({
				url: '{% url "restaurant:add_to_cart" %}',
				method: 'GET',
				success: function(res) {
					cartupdate(res);
				}
			});
		};
	</script>
	<script>
		$("#cart-section").on("click", ".increase-qty", function() {
			var item_id = $(this).data("id");
			var resid = $(this).data("resid");
			var rdistance = localStorage.getItem('rdistance'+resid);
			$.ajax({
				url: '{% url "restaurant:add_to_cart" %}',
				method: 'PATCH',
				contentType: 'application/x-www-form-urlencoded',
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					'item_id': item_id,
					'type': "increase",
					'rdistance': rdistance ? rdistance : 0,
				},
				success: function(res) {
					cartupdate(res);
				}
			})
		});
	</script>
	<script>
		$("#cart-section").on("click", ".decrease-qty", function() {
			var item_id = $(this).data("id");
			var resid = $(this).data("resid");
			var rdistance = localStorage.getItem('rdistance'+resid);

			$.ajax({
				url: '{% url "restaurant:add_to_cart" %}',
				method: 'PATCH',
				contentType: 'application/x-www-form-urlencoded',
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					'item_id': item_id,
					'type': "decrease",
					'rdistance': rdistance ? rdistance : 0,
				},
				success: function(res) {
					cartupdate(res);
				}
			});
		});

	</script>
	<script>
		$(".increase-qty").on("click", function() {
			var item_id = $(this).data("id");
			var resid = $(this).data("resid");
			var rdistance = localStorage.getItem('rdistance'+resid);

			$.ajax({
				url: '{% url "restaurant:add_to_cart" %}',
				method: 'PATCH',
				contentType: 'application/x-www-form-urlencoded',
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					'item_id': item_id,
					'type': "increase",
					'rdistance': rdistance ? rdistance : 0,
				},
			success: function(res) {
					cartupdate(res);
				}
			});
		});

	</script>
	<script>
		$(".decrease-qty").on("click", function() {
			var item_id = $(this).data("id");
			var resid = $(this).data("resid");
			var rdistance = localStorage.getItem('rdistance'+resid);

			$.ajax({
				url: '{% url "restaurant:add_to_cart" %}',
				method: 'PATCH',
				contentType: 'application/x-www-form-urlencoded',
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					'item_id': item_id,
					'type': "decrease",
					'rdistance': rdistance ? rdistance : 0,
				},
			success: function(res) {
					cartupdate(res);
				}
			});
		});
	</script>

	<script>
		$(document).ready(function () {
			$(".switch-wrap").on("click", ".switch-ot", function () {
				var option = $(this).data("id");
				var resid = $(this).data("resid");
				var distance = parseFloat(localStorage.getItem('rdistance'+resid));
				$('#deliveryWarn').hide()
				if (distance > 15) {
					$('#deliveryWarn').show()
				}
				if (option == 'Delivery' && distance > 15) {
					$(".popup-overlay").show();
					$(".popup-message").text("Delivery is not available for distances greater than 15 km.");
					return;
				}

				if (option == 'Delivery') {
					$("#delivery-option").addClass('active');
					$("#pickup-option").removeClass('active');
				} else {
					$("#delivery-option").removeClass('active');
					$("#pickup-option").addClass('active');
				}
				localStorage.setItem('order_type', option);
				$.ajax({
					url: '{% url "restaurant:update_order_type" %}',
					method: 'POST',
					data: {
						csrfmiddlewaretoken: '{{ csrf_token }}',
						'order_type': option,
						'resid': resid
					},
					success: function (res) {
						if (res.status === 'rchange') {
							$('#staticBackdrop').modal('show');
							$('#confirmDeleteBtn').on('click', function () {
								$.ajax({
									url: '{% url "restaurant:clear_cart" %}',
									method: 'POST',
									data: {
										csrfmiddlewaretoken: '{{ csrf_token }}',
									},
									success: function (response) {
										
										if (response.status === 'success') {
											$('#staticBackdrop').modal('hide');
											$('#successModal').modal('show');
											cartupdate(res);
										}
									},
									error: function () {
										$("#cart-message").html(`
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												Failed to delete previous items.
												<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
											</div>
										`);
									}
								});
							});
							$('#cancelDeleteBtn').on('click', function () {
								$('#staticBackdrop').modal('hide');
							});
						} else {
							cartupdate(res);
						}
					}
				});
			});
			$(".popup-close").on("click", function () {
				$(".popup-overlay").hide();
			});
		});
	</script>
	<script>
		function showToast() {
			const toastContainer = document.getElementById('toast-container');
			toastContainer.style.display = 'block';
			setTimeout(() => {
				toastContainer.style.display = 'none';
			}, 2000);
		}
	</script>
	<script>
		$("#apply-voucher").on("click", function(e) {
			e.preventDefault();
			let code = $(this).parent().find("input").val();
			let total = $(this).parent().parent().parent().find(".dtotal span").text();
			$.ajax({
				url: '{% url "restaurant:validate_voucher" %}',
				method: 'POST',
				contentType: 'application/x-www-form-urlencoded',
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					'voucher_code': code,
					'total_amount': total
				},
				success: function(res) {
					if (res['status'] === 'success') {
						total = parseInt(res['total']);
						$('#cart-section').find(".dtotal").find('span').text(total);
						$("#apply-voucher").attr("disabled", true);
						$("#voucher-code").attr("disabled", true);
						$("#voucher_id").val(res['id']);
						var voucher = `<div class="cart-item">
							<p class="dcharge">Voucher Charge: - <span>${res['discount']}</span></p>
						</div>`
						$('#cart-section').find(".price-div").before(voucher);
						alert(`Voucher applied! You saved $${res['discount']}.`);
					} else {
						alert(data.message);
					}
				}
			})
		})
	</script>
	<script>
		$("#desktop-menu").on("click", function () {
			$("#cart-section").addClass('show');
			$(".cart-drop").addClass('show');
		});
		$("#close-cart").on("click", function () {
			$("#cart-section").removeClass('show');
			$(".cart-drop").removeClass('show');
		});
		$(document).on("click", function (event) {
			if (!$(event.target).closest("#cart-section, #desktop-menu").length) {
				$("#cart-section").removeClass('show');
				$(".cart-drop").removeClass('show').css('display', 'none');
			}
			});
		$("#cart-section").on("click", function (event) {
			event.stopPropagation();
		});

	</script>
	<script>
		function toggleVisibility() {
			var content = document.getElementById("content");
			var body = document.body;

			if (content.style.display === "none") {
				content.style.display = "block";
				body.classList.add("menu-open");
			} else {
				content.style.display = "none";
				body.classList.remove("menu-open");
			}
		}
	</script>
	<script>
		document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
			if(toggle){
				toggle.addEventListener('click', function(event) {
					event.preventDefault();
					var parent = this.parentNode;
					var dropdownContent = parent.querySelector('.dropdown-content');

					if (window.innerWidth <= 768) {
						parent.classList.toggle('active');
						dropdownContent.style.display = parent.classList.contains('active') ? 'block' : 'none';
					}
				});
			}
		});
	</script>
	<script>
		function trackLocation() {
			navigator.geolocation.getCurrentPosition(
				function(position) {
					console.log("Initial Position: ", position.coords.latitude, position.coords.longitude);
				},
				function(error) {
					console.error("Error: ", error);
				},
				{ enableHighAccuracy: true }
			);
		}
		trackLocation();
	</script>
	<script>
		function calculateMatrixDistance(lat1, lon1, lat2, lon2, useraddress, restaddress, callback) {
			console.log("inside function", lat1, lon1, lat2, lon2, useraddress, restaddress);
            const service = new google.maps.DistanceMatrixService();
			// build request
			let origin1 = null;
			let destinationB = null;
			if (useraddress) {
				origin1 = useraddress;
			}
			else {
				origin1 = { lat: parseFloat(lat1), lng: parseFloat(lon1) };
			}
			// const origin2 = "D-21, Mahalaxmi Nagar Rd, D-Block, Malviya Nagar, Jaipur, Rajasthan 302017";
			// const destinationA = "302006, Railway, Station Rd, Gopalbari, Jaipur, Rajasthan 302006";
			// if (!restaddress) {
				destinationB = { lat: parseFloat(lat2), lng: parseFloat(lon2) };
			// }
			// else {
			// 	destinationB = restaddress;
			// }
			const request = {
				origins: [origin1],
				destinations: [destinationB],
				travelMode: google.maps.TravelMode.DRIVING,
				unitSystem: google.maps.UnitSystem.METRIC,
				avoidHighways: false,
				avoidTolls: false,
			};
			let loadDist = false
			// get distance matrix response
			service.getDistanceMatrix(request).then((response) => {
				console.log(response, "response")
				loadDist = true
				if (response?.rows.length > 0) {
						let value = response?.rows[0]?.elements[0]?.distance?.value / 1000; // Convert meters to kilometers
						callback(value); // Call the callback function with the result
				}
			}).catch(e=>{
			})

			setTimeout(()=>{
				if(!loadDist){
					let fallbackDistance = calculateDistance(lat1, lon1, lat2, lon2);
            		callback(fallbackDistance);
				}
			},[3000])
            // $.ajax({
            //     url: 'https://maps.googleapis.com/maps/api/distancematrix/json',
            //     data: {
            //         destinations: restaddress,
            //         origins: useraddress,
            //         units: 'metric',
            //         key: 'AIzaSyAJyohCbfGZAjBsj2HddGPlY3YjwJ3i1To'
            //     },
            //     success: function(response) {
            //         console.log('Distance Matrix API Response:', response);
            //         if (response?.rows.length > 0 && response?.status === 'OK') {
            //             let value = response?.rows[0]?.elements[0]?.distance?.value / 1000; // Convert meters to kilometers
            //             callback(value); // Call the callback function with the result
            //         } else {
            //             let fallbackDistance = calculateDistance(lat1, lon1, lat2, lon2);
            //             callback(fallbackDistance);
            //         }
            //     },
            //     error: function(error) {
            //         console.error('Error with Distance Matrix API:', error);
            //         let fallbackDistance = calculateDistance(lat1, lon1, lat2, lon2);
            //         callback(fallbackDistance);
            //     }
            // });
		}
		function calculateDistance(lat1, lon1, lat2, lon2) {
			const R = 6371;
			const dLat = (lat2 - lat1) * (Math.PI / 180);
			const dLon = (lon2 - lon1) * (Math.PI / 180);
			const a =
				Math.sin(dLat / 2) * Math.sin(dLat / 2) +
				Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *
				Math.sin(dLon / 2) * Math.sin(dLon / 2);
			const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
			return R * c; ''
		}
		function displayDistances() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					let userLat = position.coords.latitude;
					let userLon = position.coords.longitude;
					let useraddress = {{ user_address|default:"null" |safe }};
					if(useraddress){
						userLat = useraddress.lat
						userLon = useraddress.long;
						useraddress = useraddress.add;
					}
					document.querySelectorAll('.restaurant-card').forEach(function(card) {
					const restaurantLat = parseFloat(card.getAttribute('data-latitude'));
					const restaurantLon = parseFloat(card.getAttribute('data-longitude'));
					const restaddress = card.getAttribute('data-address');
					const restaurantID = parseInt(card.getAttribute('data-id'));
					calculateMatrixDistance(userLat, userLon, restaurantLat, restaurantLon, useraddress, restaddress, function(distance) {
					console.log("final distance", distance.toFixed(2) + " km");
							if (distance.toFixed(2) != "NaN") {
								localStorage.setItem('rdistance'+restaurantID, distance.toFixed(2));
					card.querySelector('.distance').innerText = `Distance: ${distance.toFixed(2)} km`;
							}
							else {
								card.querySelector('.distance').innerText = '';
					}
				});
			});
		});
			} else {
			console.error("Geolocation is not supported by this browser.");
		}
		}

		document.addEventListener('DOMContentLoaded', displayDistances);
	</script>
	<script>
		let checkout = document.getElementById('checkout')
	if(checkout){
		checkout.addEventListener('click', function() {
				document.getElementById('cart-form').submit();
			});
		}
	</script>


	{% comment %} food items {% endcomment %}
	<script>
		let currentEditId = null;

		function openCreateForm() {
			currentEditId = null;
			$('#foodItemForm')[0].reset();
			$('#foodItemModal').modal('show');
		}

		$('.EditFoodItem').on("click", function() {
			currentEditId =  $(this).data('slug')
			var $row = $(`#foodItem-${currentEditId}`);
			var title = $row.find('.food-title').text();
			var category = $row.find('.food-category').data('category');
			var cuisine = $row.find('.food-cuisine').data('cuisine');
			var price = $row.find('.food-price').text();
			var available = $row.find('.food-available').data('available').trim() === 'True';
			$('#id_title').val(title);
			$('#id_category').val(category);
			$('#id_cuisine').val(cuisine);
			$('#id_price').val(price);
			$('#id_available').prop('checked', available);
			$('#foodItemModal').modal('show');
		});


		$('.saveFoodItem').on("click", function() {
			let restro = $(this).data('restaurant')
			let url = '{% url "restaurant:create_food_item" restro=0 %}'.replace('0',restro)
			if(currentEditId){
				url = '{% url "restaurant:edit_food_item" restro=0 slug=1 %}'.replace('0',restro).replace('1',currentEditId)
			}
			$.ajax({
				url: url,
				method: 'POST',
				data: new FormData($('#foodItemForm')[0]),
				processData: false,
				contentType: false,
				success: function(response) {
					if (response.status === 'success') {
						$('#foodItemModal').modal('hide');
						location.reload(); // Refresh the page to see the updated table
					} else {
						// Handle validation errors
					}
				}
			});
		});
		$('.deleteFoodItem').on("click", function() {
			let restro = $(this).data('restaurant')
			let slug = $(this).data('slug')
			if (confirm('Are you sure you want to delete this item?')) {
				$.ajax({
					url: '{% url "restaurant:delete_food_item" restro=0 slug=1 %}'.replace('0',restro).replace('1',slug) ,
					//`/restaurant/my-restaurant/${restro}/food-items/${slug}/delete/`,
					type: 'POST',
					headers: {
						'X-CSRFToken': '{{ csrf_token }}'
					},
					success: function(response) {
						if (response.status === 'success') {
							$(`#foodItem-${slug}`).remove();
						}
					},
					error: function(xhr, status, error) {
						console.error('Error deleting item:', status, error);
					}
				});
			}
		});
	</script>
	<script>
		function sendTokenToServer(currentToken) {
			$.ajax({
				type: 'POST',
				url: '{% url "home:fcm_token" %}',
				data: {
					'token': currentToken,
					'csrfmiddlewaretoken': '{{ csrf_token }}'  // Ensure this token is available in the template context
				},
				success: function(response) {
					console.log('Token saved or retrieved:', response);
				},
				error: function(xhr, status, error) {
					console.error('Error saving token:', xhr.responseText);
				}
			});
		}		
	</script>
	<script>
		document.getElementById('desktop-menu').addEventListener('click', function() {
			var cartDiv = document.querySelector('.cart-drop');
			cartDiv.style.display = 'block';
		});
		document.getElementById('close-cart').addEventListener('click', function() {
			var cartDiv = document.querySelector('.cart-drop');
			cartDiv.style.display = 'none';
		});
	</script>

</body>
</html>