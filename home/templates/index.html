{% load static %}
<!DOCTYPE html>
<html class="wide wow-animation" lang="en">

<head>
	<title>{% block title %}{% endblock %} Order Easy</title>
	<meta name="viewport" content="width=device-width height=device-height initial-scale=1.0">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="icon" href="{% static 'images/order-easy.png' %}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
	<link rel="stylesheet" href="https://bslthemes.com/bslthms-advanced-btns/assets/style.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<!-- CSS only -->
	<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
	<link rel="stylesheet" href="{% static 'css/own.css' %}">
	<link rel="stylesheet" href="{% static 'css/own-car.css' %}">
	<link rel="stylesheet" href="{% static 'css/nice.css' %}">
	<link rel="stylesheet" href="{% static 'css/color.css' %}">
	<link rel="stylesheet" href="{% static 'css/aos.css' %}">
	<link rel="stylesheet" href="{% static 'css/new.css' %}">
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
</head>

<body style="word-wrap: break-word;">
	<div class="page-loader">
		<div class="wrapper">
			<div class="circle"></div>
			<div class="circle"></div>
			<div class="circle"></div>
			<div class="shadow"></div>
			<div class="shadow"></div>
			<div class="shadow"></div>
			<span>Loading</span>
		</div>
	</div>
	<header class="pb-0">
		<div class="container">
			<div class="d-flex row  mx-0" >
				<div class="col-3">
					<div class="header-style">
						<a href="{% url 'home:home-page' %}">
							<img src="{% static 'images/order-easy.png' %}" class="img-fluid log-imag" alt="logo.png"
								height="150px" width="200px">
						</a>
						<div class="extras bag">
							<a href="javascript:void(0)" class="menu-btn">
								<i class="fa-solid fa-bag-shopping"></i>
							</a>
							<div>
								<i class="fa-solid fa-bars"></i>
							</div>
						</div>
					</div>
				</div>
				<div id="web" class="d-flex col-9" style="justify-content: space-around;">
					<div id="navbar-container" class="d-flex col-8">
						<nav class="navbar">
							<ul class="navbar-links">
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'home-page' %}active{% endif %}">
									<a href="{% url 'home:home-page' %}">Home</a>
								</li>
								{% if request.user and request.user.role == 'Owner' %}
									<li class="navbar-dropdown {% if request.resolver_match.url_name == 'my_restaurant' %}active{% endif %}">
										<a href="{% url 'restaurant:my_restaurant' %}">My Restaurants</a>
									</li>
								{% else %}
									<li class="navbar-dropdown {% if request.resolver_match.url_name == 'restaurant' %}active{% endif %}">
										<a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
									</li>
								{% endif %}
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'blog_page' %}active{% endif %}">
									<a href="{% url 'blog:blog_page' %}">Blog</a>
								</li>
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'about-page' %}active{% endif %}">
									<a href="{% url 'home:about-page' %}">About Us</a>
								</li>
								
								<!-- <li class="navbar-dropdown">
									<a href="JavaScript:void(0)">Pages</a>
									<div class="dropdown">
										<a href="{% url 'blog:blog_page' %}">Blog</a>
										<a href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single Blog</a>
										<a href="{% url 'blog:service' %}">Services</a> 
										<a href="{% url 'home:faq' %}">FAQ</a>
										<a href="{% url  'home:pricing-table'  %}">Pricing Table</a>
										<a href="{% url  'home:become-partner'  %}">Become A Partner</a>
										<a href="{% url  'home:page-not-found'  %}">404</a>
									</div>
								</li> -->
								<li class="navbar-dropdown {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
									<a href="{% url  'home:contact'  %}">Contact</a>
								</li>
								
							</ul>
						</nav>
					</div>
					<div class="d-flex col-3 " style="justify-content: end; margin: auto;">
						{% if request.user and request.user.role == 'Owner' %}
						{% else %}
							<div class="extras bag">
								<a href="javascript:void(0)" id="desktop-menu" class="menu-btn">
									<i class="fa-solid fa-bag-shopping"></i>
								</a>							
								<!-- Cart Section -->
								<div id="cart-section" class="cart-sidebar">
									<div class="cart-header">
										<h2>My Cart</h2>
										<button id="close-cart" class="btn btn-info">Close</button>
									</div>
									<form id="cart-form" method="POST" action="{% url 'home:checkout' %}">
										{% csrf_token %}
										<div id="cart-content">
											<div id="cart-items"></div>
											<input type="hidden" id="order-type-input" name="order_type" value="Delivery">                                
											<input type="hidden" id="restaurent-input" name="restaurent_id">                                
											<input type="hidden" id="dcharge" name="charge">      
											<input type="hidden" id="voucher_id" name="voucher_id">                          
											<div class="omc-sv">
												<div class="voucher-code voucher-section mt-4">
													<input type="text" name="VoucherCode" id="voucher-code"
														class="form-control om-voucher-code" placeholder="Enter voucher code" data-sid="1166">
													<button class="btn add-voucher" id="apply-voucher">Add</button>
												</div>
											</div>
											<input type="hidden" name="cart_data" id="cart-data">    
											<div class="cart-footer">
												<p id="total-amount"></p>
												<button type="submit" id="checkout" name="cart_checkout" class="btn btn-success">Checkout</button>
											</div>
										</div>
									</form>
								</div>
								<!-- <a href="{% url 'restaurant:restaurant' %}" class="button button-2">Order Now</a> -->
							</div>
						{% endif %}
						<div class="bag">
							{% if user.is_authenticated %}
								<a href="{% url 'home:logout' %}" class="button button-2">Logout</a>
							{% else %}
								<a href="{% url 'home:login' %}" class="button button-2">Register</a>
							{% endif %}
						</div>
					</div>
				</div>
				<div class="side-menu" id="content" style="display: none;">
					<button  onclick="toggleVisibility()" class="border-0" style="float: right !important; background-color: none;">
						<i class="fa-solid fa-close" aria-hidden="true" style=" color: #F29F05 ;"></i>
					</button>
					<nav class="navbar">
						<ul class="">
							<a href="{% url 'home:home-page' %}">
								<img src="{% static 'images/order-easy.png' %}" class="img-fluid log-imag" alt="logo.png"
									height="100px" width="150px">
							</a>
							<li class="navbar-dropdown active">
								<a href="{% url 'home:home-page' %}">Home</a>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="{% url 'home:about-page' %}">About Us</a>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="javascript:void(0)" class="dropdown-toggle">Restaurants</a>
								<div class="dropdown-content">
									<a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
									{% if restaurants and restaurants.first %}
									<a href="{% url 'restaurant:restaurant-card' slug=restaurants.first.slug %}">Restaurant Card</a>
								{% else %}
									<a href="">Restaurant Card</a>
								{% endif %}									
								<a href="{% url  'home:checkout'  %}">Checkout</a>
								</div>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="javascript:void(0)" class="dropdown-toggle">Pages</a>
								<div class="dropdown-content">
									<a href="{% url 'blog:blog_page' %}">Blog</a>
									<a href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single Blog</a>
									<a href="{% url  'blog:service'  %}">Services</a> 
									<a href="{% url 'home:faq' %}">FAQ</a>
									<a href="{% url  'home:pricing-table'  %}">Pricing Table</a>
									<a href="{% url  'home:become-partner'  %}">Become A Partner</a>
									<a href="{% url  'home:page-not-found'  %}">404</a>
								</div>
							</li>
							<hr>
							<li class="navbar-dropdown">
								<a href="{% url  'home:contact'  %}">Contacts</a>
							</li>
							<hr>
						</ul>
					</nav>
				</div>
				<div id="mobile" style="display: none;" class=" col-4 justify-content-end">
					<div class="extras bag d-flex">
						<a href="javascript:void(0)" id="desktop-menu" class="menu-btn">
							<i class="fa-solid fa-bag-shopping"></i>
						</a>
						<button  onclick="toggleVisibility()" class="border-0" style="background-color: transparent !important;">
							<i class="fa-solid fa-bars" aria-hidden="true"></i>
						</button>
					</div>
				</div>
				<div class="menu-wrap d-none">
					<div class="menu-inner ps ps--active-x ps--active-y">
						<span class="menu-cls-btn"><i class="cls-leftright"></i><i class="cls-rightleft"></i></span>
						<div class="checkout-order">
							<div class="title-checkout">
								<h2>My Orders</h2>
							</div>
							<div class="banner-wilmington">
								<img alt="logo" src="https://bslthemes.com/html/quickeat/assets/img/logo-s.jpg">
								<h6>Kennington Lane Cafe</h6>
							</div>
							<ul>
								<li class="price-list">
									<i class="closeButton fa-solid fa-xmark"></i>
									<div class="counter-container">
										<div class="counter-food">
											<img alt="food"
												src="https://bslthemes.com/html/quickeat/assets/img/dish-6.png">
											<h4>Pasta, kiwi and sauce chilli</h4>
										</div>
										<h3>NZ$39</h3>
									</div>
									<div class="price">
										<div>
											<h2>NZ$39</h2>
											<span>Sum</span>
										</div>
										<div>
											<div class="qty-input">
												<button class="qty-count qty-count--minus" data-action="minus"
													type="button">-</button>
												<input class="product-qty" type="number" name="product-qty" min="0"
													value="1">
												<button class="qty-count qty-count--add" data-action="add"
													type="button">+</button>
											</div>
											<span>Quantity</span>
										</div>
									</div>
								</li>
								<li class="price-list">
									<i class="closeButton fa-solid fa-xmark"></i>
									<div class="counter-container">
										<div class="counter-food">
											<img alt="food"
												src="https://bslthemes.com/html/quickeat/assets/img/dish-7.png">
											<h4>Rice with shrimps and kiwi</h4>
										</div>
										<h3>NZ$49</h3>
									</div>
									<div class="price">
										<div>
											<h2>NZ$49</h2>
											<span>Sum</span>
										</div>
										<div>
											<div class="qty-input">
												<button class="qty-count qty-count--minus" data-action="minus"
													type="button">-</button>
												<input class="product-qty" type="number" name="product-qty" min="0"
													value="1">
												<button class="qty-count qty-count--add" data-action="add"
													type="button">+</button>
											</div>
											<span>Quantity</span>
										</div>
									</div>
								</li>
							</ul>
							<div class="totel-price">
								<span>Total order:</span>
								<h5>NZ$137</h5>
							</div>
							<div class="totel-price">
								<span>To pay:</span>
								<h2>NZ$137</h2>
							</div>
							<button class="button-price">Checkout</button>

						</div>
					</div>
				</div>
				<div class="mobile-nav hmburger-menu" id="mobile-nav" style="display:block;">
					<div class="res-log">
						<a href="{% url 'home:home-page' %}">
							<svg xmlns="http://www.w3.org/2000/svg" width="163" height="38" viewBox="0 0 163 38">
								<g id="Logo-m" transform="translate(-260 -51)">
									<g id="Logo-2-m" data-name="Logo" transform="translate(260 51)">
										<g id="Elements-m">
											<path id="Path_3429" data-name="Path 3429"
												d="M315.086,140.507H275.222v-.894c0-11.325,8.941-20.538,19.933-20.538s19.931,9.213,19.931,20.538Z"
												transform="translate(-270.155 -115.396)" fill="#f29f05" />
											<path id="Path_3430" data-name="Path 3430"
												d="M301.13,133.517a1.488,1.488,0,0,1-1.394-.994,11.361,11.361,0,0,0-10.583-7.54,1.528,1.528,0,0,1,0-3.055,14.353,14.353,0,0,1,13.37,9.527,1.541,1.541,0,0,1-.875,1.966A1.444,1.444,0,0,1,301.13,133.517Z"
												transform="translate(-264.176 -113.935)" fill="#fff" />
											<path id="Path_3431" data-name="Path 3431"
												d="M297.343,146.544a14.043,14.043,0,0,1-13.837-14.211h2.975a10.865,10.865,0,1,0,21.723,0h2.975A14.043,14.043,0,0,1,297.343,146.544Z"
												transform="translate(-266.247 -108.544)" fill="#363636" />
											<path id="Path_3432" data-name="Path 3432"
												d="M302.183,132.519a7.064,7.064,0,1,1-14.122,0Z"
												transform="translate(-264.027 -108.446)" fill="#363636" />
											<path id="Path_3433" data-name="Path 3433"
												d="M320.332,134.575H273.3a1.528,1.528,0,0,1,0-3.055h47.033a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-271.815 -108.923)" fill="#f29f05" />
											<path id="Path_3434" data-name="Path 3434"
												d="M289.154,123.4a1.507,1.507,0,0,1-1.487-1.528v-3.678a1.488,1.488,0,1,1,2.975,0v3.678A1.508,1.508,0,0,1,289.154,123.4Z"
												transform="translate(-264.154 -116.667)" fill="#f29f05" />
											<path id="Path_3435" data-name="Path 3435"
												d="M284.777,138.133H275.3a1.528,1.528,0,0,1,0-3.055h9.474a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-270.84 -107.068)" fill="#363636" />
											<path id="Path_3436" data-name="Path 3436"
												d="M284.8,141.691h-6.5a1.528,1.528,0,0,1,0-3.055h6.5a1.528,1.528,0,0,1,0,3.055Z"
												transform="translate(-269.379 -105.218)" fill="#363636" />
										</g>
									</g>
									<text id="Quickeat-m" transform="translate(320 77)" fill="#363636" font-size="20"
										font-family="Poppins" font-weight="700">
										<tspan x="0" y="0">QUICK</tspan>
										<tspan y="0" fill="#f29f05">EAT</tspan>
									</text>
								</g>
							</svg>
						</a>
					</div>
					<ul>
						<li><a href="{% url 'home:home-page' %}">Home</a>
						</li>
						<li><a href="{% url 'home:about-page' %}">About Us</a></li>
						<li class="menu-item-has-children"><a href="{% url 'restaurant:restaurant' %}">Restaurants</a>
							<!-- <ul class="sub-menu">
								<li><a href="{% url 'restaurant:restaurant' %}">Restaurants</a></li>
								<li>     {% if restaurants and restaurants.first %}
									<a href="{% url 'restaurant:restaurant-card' slug=restaurants.first.slug %}">Restaurant Card</a>
								{% else %}
									<a href="">Restaurant Card</a> 
								{% endif %}
								</li>
								<li><a href="{% url  'home:checkout'  %}">Checkout</a></li>
							</ul> -->
						</li>
						<li class="menu-item-has-children"><a href="JavaScript:void(0)">Pages</a>
							<ul class="sub-menu">
								<li><a href="{% url 'blog:blog_page' %}">Blog</a></li>
								<li><a
										href="{% if post.last %}{% url  'blog:blog_detail' post.last.slug  %}{% else %} javascript:void(0);{% endif %}">Single
										Blog</a>
								</li>
								{% comment %} <li><a href="{% url  'blog:service'  %}">Services</a></li> {% endcomment %}
								<li><a href="{% url 'home:faq' %}">FAQ</a></li>
								<li><a href="{% url  'home:pricing-table'  %}">Pricing Table</a></li>
								<li><a href="{% url  'home:become-partner'  %}">Become A Partner</a></li>
								<li><a href="{% url  'home:page-not-found'  %}">404</a></li>
							</ul>
						</li>
						<li><a href="{% url  'home:contact'  %}">contacts</a></li>
					</ul>
					<a href="JavaScript:void(0)" id="res-cross"></a>
				</div>
			</div>
		</div>
		{% if messages %}
		<div class="messages">
			{% for message in messages %}
			<div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
				{{ message }}
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
			{% endfor %}
		</div>
		{% endif %}
	</header>
	{% block content %}

	{% endblock %}
	<footer class="gap no-bottom" style="background-color: #363636;">
		<div class="container">
			<div class="row mx-0">
				<div class="col-lg-5 col-md-6 col-sm-12">
					<div class="footer-description" style="word-wrap: break-word;">
						<a href="{% url 'home:home-page' %}">
							<img src="{% static 'images/order-easy.png' %}" alt="logo.png" class="foot-img" height="150px">
						</a>
						<h2>The Best Restaurants
							in Your Home</h2>
						<p>Vitae congue mauris rhoncus aenean. Enim nulla
							aliquet porttitor lacus luctus accumsan
							tortor posuere. Tempus egestas sed sed risus pretium quam.</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-12">
					<div class="menu">
						<h4>Menu</h4>
						<ul class="footer-menu">
							<li><a href="{% url 'home:home-page' %}">home<i class="fa-solid fa-arrow-right"></i></a>
							</li>
							<li><a href="{% url 'home:about-page' %}">about us<i
										class="fa-solid fa-arrow-right"></i></a></li>
							<li><a href="{% url 'restaurant:restaurant' %}">Restaurants<i
										class="fa-solid fa-arrow-right"></i></a></li>
							<li><a href="{% url  'home:contact'  %}">Contacts<i class="fa-solid fa-arrow-right"></i></a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 col-sm-12">
					<div class="menu contacts">
						<h4>Contacts</h4>
						<div class="footer-location">
							<i class="fa-solid fa-location-dot"></i>
							<p>1717 Harrison St, San Francisco, CA 94103,
								United States</p>
						</div>
						<a href="mailto:quickeat@mail.net"><i class="fa-solid fa-envelope"></i>quickeat@mail.net</a>
						<a href="callto:+14253261627"><i class="fa-solid fa-phone"></i>+1 425 326 16 27</a>
					</div>
					<ul class="social-media">
						<li><a href="javascript:void(0)"><i class="fa-brands fa-facebook-f"></i></a></li>
						<li><a href="javascript:void(0)"><i class="fa-brands fa-instagram"></i></a></li>
						<li><a href="javascript:void(0)"><i class="fa-brands fa-twitter"></i></a></li>
					</ul>
				</div>
			</div>
			<div class="footer-two gap no-bottom">
				<p>Copyright Â© {% now "Y" %}. OrderEasy. All rights reserved.</p>
				<div class="privacy">
					<a href="javascript:void(0)">Privacy Policy</a>
					<a href="javascript:void(0)">Terms & Services</a>
				</div>
			</div>
		</div>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
		crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
	<script src="{% static 'js/fast.js' %}"></script>
	<script src="{% static 'js/eat.js' %}"></script>
	<script src="{% static 'js/aos.js' %}"></script>
	<script src="{% static 'js/custom.js' %}"></script>
	<script src="{% static 'js/ownchar.js' %}"></script>
	<script type="module">
        // Initialize Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-messaging.js";

        const firebaseConfig = {
			apiKey: "AIzaSyBZgRCZexv8ErSYGyo6IpbO1Q438e-CFTA",
			authDomain: "timestint-st.firebaseapp.com",
			projectId: "timestint-st",
			storageBucket: "timestint-st.appspot.com",
			messagingSenderId: "507688135519",
			appId: "1:507688135519:web:1b3a39ef85863310fce4ea",
			measurementId: "G-6XJ70609DK"
        };

        const app = initializeApp(firebaseConfig);
        const messaging = getMessaging();

        // Get the device token
        getToken(messaging, { vapidKey: 'BHzwzJsxsIu-lTCvdZQfK1eqfCJd1tqDzGySY9DEjX6CwlZA1LB42062q2bv9uH3B2R18H_TVxbGVZl9X0yZjwI' }).then((currentToken) => {
            if (currentToken) {
                sendTokenToServer(currentToken);
                console.log("Token is: ", currentToken);
            } else {
                console.log('No registration token available. Request permission to generate one.');
            }
        }).catch((err) => {
            console.log('An error occurred while retrieving token: ', err);
        });

        // Register Service Worker for Firebase Messaging
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('js/firebase-messaging-sw.js')
            .then(function(registration) {
                console.log('Service Worker registered with scope:', registration.scope);
            }).catch(function(err) {
                console.log('Service Worker registration failed:', err);
            });
        }
    </script>
	{% block script_js %}
	{% endblock %}
	<script>
		function toggleVisibility() {
		var content = document.getElementById("content");
		var body = document.body;
		
		if (content.style.display === "none") {
			content.style.display = "block";
			body.classList.add("menu-open");
		} else {
			content.style.display = "none";
			body.classList.remove("menu-open");
		}
	}
	</script>
	<script>
		document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
			if(toggle){
				toggle.addEventListener('click', function(event) {
					event.preventDefault();
					var parent = this.parentNode;
					var dropdownContent = parent.querySelector('.dropdown-content');
	
					if (window.innerWidth <= 768) {
						parent.classList.toggle('active');
						dropdownContent.style.display = parent.classList.contains('active') ? 'block' : 'none';
					}
				});
			}
	});
	</script>
	<script>
		function getUserLocation() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(
					function(position) {
						const latitude = position.coords.latitude;
						const longitude = position.coords.longitude;
		
						console.log("Latitude:", latitude);
						console.log("Longitude:", longitude);
						/*
						fetch('/save-location/', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
								'X-CSRFToken': getCookie('csrftoken')  // For Django CSRF protection
							},
							body: JSON.stringify({ latitude: latitude, longitude: longitude })
						}).then(response => response.json())
						  .then(data => console.log(data))
						  .catch(error => console.error('Error:', error));
						*/
					},
					function(error) {
						console.error("Error Code = " + error.code + " - " + error.message);
					}
				);
			} else {
				console.error("Geolocation is not supported by this browser.");
			}
		}
		getUserLocation();		
	</script>
	<script>
	function calculateDistance(lat1, lon1, lat2, lon2) {
		const R = 6371; 
		const dLat = (lat2 - lat1) * (Math.PI / 180);
		const dLon = (lon2 - lon1) * (Math.PI / 180);
		const a = 
			Math.sin(dLat / 2) * Math.sin(dLat / 2) +
			Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) * 
			Math.sin(dLon / 2) * Math.sin(dLon / 2); 
		const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
		return R * c; 
	}
	function displayDistances() {
		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position) {
				const userLat = position.coords.latitude;
				const userLon = position.coords.longitude;
				document.querySelectorAll('.restaurant-card').forEach(function(card) {
					const restaurantLat = parseFloat(card.getAttribute('data-latitude'));
					const restaurantLon = parseFloat(card.getAttribute('data-longitude'));
	
					const distance = calculateDistance(userLat, userLon, restaurantLat, restaurantLon);
					card.querySelector('.distance').innerText = `Distance: ${distance.toFixed(2)} km`;
				   
				});
			});
		} else {
			console.error("Geolocation is not supported by this browser.");
		}
	}
	
	document.addEventListener('DOMContentLoaded', displayDistances);
</script>
<script>
	let checkout = document.getElementById('checkout')
	if(checkout){
		checkout.addEventListener('click', function() {
			document.getElementById('cart-form').submit();
		});
	}
</script>


{% comment %} food items {% endcomment %}
<script>
		let currentEditId = null;
		
		function openCreateForm() {
			currentEditId = null;
			$('#foodItemForm')[0].reset();
			$('#foodItemModal').modal('show');
		}
		
		$('.EditFoodItem').on("click", function() {
			currentEditId =  $(this).data('slug')
			var $row = $(`#foodItem-${currentEditId}`);
			var title = $row.find('.food-title').text();
			var category = $row.find('.food-category').data('category');
			var cuisine = $row.find('.food-cuisine').data('cuisine');
			var start = $row.find('.food-start').data('start');
			var end = $row.find('.food-end').data('end');
			var price = $row.find('.food-price').text();
			console.log(title,category,cuisine,start,end,price)
			var available = $row.find('.food-available').data('available').trim() === 'True';
			$('#id_title').val(title);
			$('#id_category').val(category); 
			$('#id_cuisine').val(cuisine); 
			$('#id_start').val(start);
			$('#id_end').val(end);
			$('#id_price').val(price);
			$('#id_available').prop('checked', available);
			$('#foodItemModal').modal('show');
		});
		
		
		$('.saveFoodItem').on("click", function() {
			let restro = $(this).data('restaurant')
			let url = '{% url "restaurant:create_food_item" restro=0 %}'.replace('0',restro)
			if(currentEditId){
				url = '{% url "restaurant:edit_food_item" restro=0 slug=1 %}'.replace('0',restro).replace('1',currentEditId)
			}
			$.ajax({
				url: url,
				method: 'POST',
				data: new FormData($('#foodItemForm')[0]),
				processData: false,
				contentType: false,
				success: function(response) {
					if (response.status === 'success') {
						$('#foodItemModal').modal('hide');
						location.reload(); // Refresh the page to see the updated table
					} else {
						// Handle validation errors
					}
				}
			});
		});
		$('.deleteFoodItem').on("click", function() {
			let restro = $(this).data('restaurant')
			let slug = $(this).data('slug')
			if (confirm('Are you sure you want to delete this item?')) {
				$.ajax({
					url: '{% url "restaurant:delete_food_item" restro=0 slug=1 %}'.replace('0',restro).replace('1',slug) ,
					//`/restaurant/my-restaurant/${restro}/food-items/${slug}/delete/`,
					type: 'POST',
					headers: {
						'X-CSRFToken': '{{ csrf_token }}'
					},
					success: function(response) {
						if (response.status === 'success') {
							$(`#foodItem-${slug}`).remove();
						}
					},
					error: function(xhr, status, error) {
						console.error('Error deleting item:', status, error);
					}
				});
			}
		});
	</script>
	<script>
		function sendTokenToServer(currentToken) {
			$.ajax({
				type: 'POST',
				url: '{% url "home:fcm_token" %}',  
				data: {
					'token': currentToken,
					'csrfmiddlewaretoken': '{{ csrf_token }}'  // Ensure this token is available in the template context
				},
				success: function(response) {
					console.log('Token saved or retrieved:', response);
				},
				error: function(xhr, status, error) {
					console.error('Error saving token:', xhr.responseText);
				}
			});
		}		
	</script>
</body>
</html>